# Examples of git commit messages generated by the OCI-aware semantic analysis plugin

Below are examples of generated commit messages, based on actual infrastructure changes.

## How does it do it?

The OCI-aware semantic analysis plugin, understands the context and impact of infrastructure changes, providing:
- **Context Awareness**: Understands OCI resource relationships
- **Security Detection**: Recognizes security improvements
- **Breaking Changes**: Identifies service-disrupting changes
- **Confidence Scoring**: Provides analysis confidence levels
- **Proper Scoping**: Automatically categorizes changes

## Example 1: Creating New OCI Network Infrastructure

### Input Diff
```diff
+resource "oci_core_vcn" "main" {
+  compartment_id = var.compartment_id
+  cidr_block     = "10.0.0.0/16"
+  dns_label      = "mainvcn"
+}
+
+resource "oci_core_internet_gateway" "main" {
+  compartment_id = var.compartment_id
+  vcn_id         = oci_core_vcn.main.id
+  display_name   = "main-igw"
+}
```

### Semantic Analysis Output
```
🧠 Semantic Analysis Results:
   Type: feat
   Scope: network
   Intent: Infrastructure provisioning
   Impact: New infrastructure components
   Breaking: false
   Confidence: 85%
   Reasoning: Added 2 Terraform resources: oci_core_vcn, oci_core_internet_gateway
```

### Generated Commit Message
```
feat(network): add network infrastructure

Infrastructure provisioning
Impact: New infrastructure components
```

## Example 2: Security Improvement - Restricting Access

### Input Diff
```diff
resource "oci_core_security_list" "web" {
   ingress_security_rules {
     protocol = "6"
-    source   = "0.0.0.0/0"
+    source   = "10.0.0.0/8"
   }
}
```

### Semantic Analysis Output
```
🧠 Semantic Analysis Results:
   Type: fix
   Scope: network
   Intent: Security hardening
   Impact: Infrastructure configuration updated
   Breaking: false
   Confidence: 90%
   Reasoning: Security improvement detected
```

### Generated Commit Message
```
fix(network): improve infrastructure security configuration

Security hardening
Impact: Infrastructure configuration updated
```

## Example 3: Breaking Change - Deleting Critical Infrastructure

### Input Diff
```diff
-resource "oci_database_autonomous_database" "main" {
-  compartment_id = var.compartment_id
-  display_name   = "main-database"
-  db_name        = "maindb"
-  cpu_core_count = 1
-  data_storage_size_in_tbs = 1
-}
```

### Semantic Analysis Output
```
🧠 Semantic Analysis Results:
   Type: feat
   Scope: storage
   Intent: Infrastructure cleanup or refactoring
   Impact: Infrastructure resources will be destroyed
   Breaking: true
   Confidence: 90%
   Reasoning: Terraform file deleted with critical resource types
```

### Generated Commit Message
```
feat(storage)!: remove Terraform configuration database.tf

Infrastructure cleanup or refactoring
Impact: Infrastructure resources will be destroyed

BREAKING CHANGE: Infrastructure changes may affect existing resources
```

## Example 4: Performance Optimization

### Input Diff
```diff
resource "oci_core_instance" "app" {
   compartment_id = var.compartment_id
-  shape          = "VM.Standard.E2.1"
+  shape          = "VM.Standard.E4.4"
+  
+  shape_config {
+    memory_in_gbs = 256
+    ocpus         = 32
+  }
}
```

### Semantic Analysis Output
```
🧠 Semantic Analysis Results:
   Type: perf
   Scope: compute
   Intent: Performance optimization
   Impact: 1 resources will be modified
   Breaking: true  # Shape changes require instance restart
   Confidence: 85%
```

### Generated Commit Message
```
perf(compute)!: optimize infrastructure performance

Performance optimization
Impact: 1 resources will be modified

BREAKING CHANGE: Infrastructure changes may affect existing resources
```

## Example 5: Adding OCI Container Engine Cluster

### Input Diff
```diff
+resource "oci_containerengine_cluster" "k8s" {
+  compartment_id     = var.compartment_id
+  kubernetes_version = "v1.28.2"
+  name              = "production-cluster"
+  vcn_id            = oci_core_vcn.main.id
+  
+  options {
+    add_ons {
+      is_kubernetes_dashboard_enabled = false
+      is_tiller_enabled               = false
+    }
+  }
+}
```

### Generated Commit Message
```
feat(compute): add critical compute infrastructure

Infrastructure provisioning
Impact: Critical infrastructure components added
```

## Example 6: Identity and Access Management

### Input Diff
```diff
+resource "oci_identity_policy" "admin_policy" {
+  compartment_id = var.tenancy_ocid
+  name           = "AdminPolicy"
+  description    = "Policy for admin users"
+  
+  statements = [
+    "Allow group Administrators to manage all-resources in tenancy"
+  ]
+}
```

### Generated Commit Message
```
feat(security): add security infrastructure

Infrastructure provisioning
Impact: Security infrastructure components added
```

## Example 7: Multi-Resource Change with Mixed Operations

### Input Diff
```diff
 resource "oci_core_vcn" "main" {
   compartment_id = var.compartment_id
-  cidr_block     = "10.0.0.0/16"
+  cidr_block     = "10.0.0.0/8"  # Expanding network range
 }

+resource "oci_core_subnet" "private" {
+  compartment_id             = var.compartment_id
+  vcn_id                     = oci_core_vcn.main.id
+  cidr_block                 = "10.1.0.0/24"
+  prohibit_public_ip_on_vnic = true
+}

-resource "oci_core_security_list" "old" {
-  compartment_id = var.compartment_id
-  vcn_id         = oci_core_vcn.main.id
-}
```

### Generated Commit Message
```
feat(network): add oci_core_subnet resource

Infrastructure expansion
Impact: 1 resources will be created; 1 resources will be destroyed; 1 resources will be modified
```

## Supported OCI Resource Types

The semantic analysis plugin recognizes and categorizes the following OCI resources:

### Critical Resources (Breaking changes when deleted)
- `oci_core_vcn` - Virtual Cloud Network
- `oci_database_autonomous_database` - Autonomous Database
- `oci_database_db_system` - Database System
- `oci_objectstorage_bucket` - Object Storage Bucket
- `oci_containerengine_cluster` - Kubernetes Cluster
- `oci_mysql_mysql_db_system` - MySQL Database System

### Security Resources
- `oci_identity_policy` - IAM Policies
- `oci_core_security_list` - Security Lists
- `oci_identity_user` - IAM Users
- `oci_identity_group` - IAM Groups
- `oci_core_network_security_group` - Network Security Groups

### Scope Detection

The plugin automatically determines the scope based on resource types:

| Resource Pattern | Detected Scope |
|-----------------|---------------|
| `oci_core_vcn`, `oci_core_subnet`, `oci_load_balancer` | network |
| `oci_identity_*`, `oci_core_security_*` | security |
| `oci_objectstorage_*`, `oci_database_*`, `oci_mysql_*` | storage |
| `oci_core_instance`, `oci_containerengine_*` | compute |
| Others | infra |

## Comparison with Rule-Based Analysis

### Rule-Based (Traditional cc command)
```
chore: update configuration files
```

### Semantic Analysis (With Plugin)
```
feat(network): add critical network infrastructure

Infrastructure provisioning
Impact: Critical infrastructure components added
Reasoning: Added 2 Terraform resources: oci_core_vcn, oci_core_internet_gateway
```

## Configuration Options

The Terraform plugin supports the following configuration options:

```yaml
terraform:
  detect_breaking_changes: true  # Detect changes that may cause service disruption
  analyze_security: true         # Identify security improvements or risks
  check_best_practices: true     # Validate against Terraform best practices
  provider_sensitivity: high     # Sensitivity level for provider changes (high/medium/low)
```

## Integration with cc Command

To use semantic analysis in your commits:

1. The cc command automatically detects Terraform files
2. Analyzes the changes using the OCI-aware plugin
3. Generates contextual commit messages
4. Provides confidence scores for the analysis

### Example Usage

```bash
# Stage your Terraform changes
git add infrastructure/*.tf

# Use cc to generate a semantic commit message
cc

# Output:
>> Made with ❤️ for Boo
🧠 Semantic Analysis Results:
   Type: feat
   Scope: network
   Intent: Infrastructure provisioning
   Impact: New infrastructure components
   Confidence: 85%

>>> based on your changes, cc created the following git commit message for you (confidence: 85%):
feat(network): add network infrastructure
```

## Benefits of Semantic Analysis

1. **Accurate Commit Types**: Automatically determines if changes are features, fixes, or breaking changes
2. **Proper Scoping**: Categorizes changes into network, compute, storage, or security
3. **Impact Assessment**: Understands the real-world impact of infrastructure changes
4. **Breaking Change Detection**: Identifies changes that require careful deployment
5. **Security Awareness**: Recognizes security improvements and potential risks
6. **Confidence Scoring**: Provides transparency about analysis certainty

## Future Enhancements

- Support for more OCI services (Load Balancer, API Gateway, etc.)
- Cross-file dependency analysis
- Cost impact estimation
- Compliance checking (CIS benchmarks, etc.)
- Multi-cloud support (AWS, Azure, GCP)